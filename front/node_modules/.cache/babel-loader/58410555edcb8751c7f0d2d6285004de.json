{"ast":null,"code":"/**\r\n * DevExtreme (esm/ui/popover/ui.popover.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\nimport { getWidth, setWidth, getHeight, setHeight } from \"../../core/utils/size\";\nimport $ from \"../../core/renderer\";\nimport { hasWindow } from \"../../core/utils/window\";\nimport { getPublicElement } from \"../../core/element\";\nimport domAdapter from \"../../core/dom_adapter\";\nimport eventsEngine from \"../../events/core/events_engine\";\nimport registerComponent from \"../../core/component_registrator\";\nimport { extend } from \"../../core/utils/extend\";\nimport { move } from \"../../animation/translator\";\nimport positionUtils from \"../../animation/position\";\nimport { isObject, isString } from \"../../core/utils/type\";\nimport { fitIntoRange } from \"../../core/utils/math\";\nimport { addNamespace } from \"../../events/utils/index\";\nimport errors from \"../widget/ui.errors\";\nimport Popup from \"../popup\";\nimport { getBoundingRect } from \"../../core/utils/position\";\nimport { PopoverPositionController, POPOVER_POSITION_ALIASES } from \"./popover_position_controller\";\nvar POPOVER_CLASS = \"dx-popover\";\nvar POPOVER_WRAPPER_CLASS = \"dx-popover-wrapper\";\nvar POPOVER_ARROW_CLASS = \"dx-popover-arrow\";\nvar POPOVER_WITHOUT_TITLE_CLASS = \"dx-popover-without-title\";\nvar POSITION_FLIP_MAP = {\n  left: \"right\",\n  top: \"bottom\",\n  right: \"left\",\n  bottom: \"top\",\n  center: \"center\"\n};\n\nvar getEventNameByOption = function (optionValue) {\n  return isObject(optionValue) ? optionValue.name : optionValue;\n};\n\nvar getEventName = function (that, optionName) {\n  var optionValue = that.option(optionName);\n  return getEventNameByOption(optionValue);\n};\n\nvar getEventDelay = function (that, optionName) {\n  var optionValue = that.option(optionName);\n  return isObject(optionValue) && optionValue.delay;\n};\n\nvar attachEvent = function (that, name) {\n  var {\n    target: target,\n    shading: shading,\n    disabled: disabled,\n    hideEvent: hideEvent\n  } = that.option();\n  var isSelector = isString(target);\n  var shouldIgnoreHideEvent = shading && \"hide\" === name;\n  var event = shouldIgnoreHideEvent ? null : getEventName(that, \"\".concat(name, \"Event\"));\n\n  if (shouldIgnoreHideEvent && hideEvent) {\n    errors.log(\"W1020\");\n  }\n\n  if (!event || disabled) {\n    return;\n  }\n\n  var eventName = addNamespace(event, that.NAME);\n\n  var action = that._createAction(function () {\n    var delay = getEventDelay(that, name + \"Event\");\n\n    this._clearEventsTimeouts();\n\n    if (delay) {\n      this._timeouts[name] = setTimeout(function () {\n        that[name]();\n      }, delay);\n    } else {\n      that[name]();\n    }\n  }.bind(that), {\n    validatingTargetName: \"target\"\n  });\n\n  var handler = function (e) {\n    action({\n      event: e,\n      target: $(e.currentTarget)\n    });\n  };\n\n  var EVENT_HANDLER_NAME = \"_\" + name + \"EventHandler\";\n\n  if (isSelector) {\n    that[EVENT_HANDLER_NAME] = handler;\n    eventsEngine.on(domAdapter.getDocument(), eventName, target, handler);\n  } else {\n    var targetElement = getPublicElement($(target));\n    that[EVENT_HANDLER_NAME] = void 0;\n    eventsEngine.on(targetElement, eventName, handler);\n  }\n};\n\nvar detachEvent = function (that, target, name, event) {\n  var eventName = event || getEventName(that, name + \"Event\");\n\n  if (!eventName) {\n    return;\n  }\n\n  eventName = addNamespace(eventName, that.NAME);\n  var EVENT_HANDLER_NAME = \"_\" + name + \"EventHandler\";\n\n  if (that[EVENT_HANDLER_NAME]) {\n    eventsEngine.off(domAdapter.getDocument(), eventName, target, that[EVENT_HANDLER_NAME]);\n  } else {\n    eventsEngine.off(getPublicElement($(target)), eventName);\n  }\n};\n\nvar Popover = Popup.inherit({\n  _getDefaultOptions: function () {\n    return extend(this.callBase(), {\n      target: void 0,\n      shading: false,\n      position: extend({}, POPOVER_POSITION_ALIASES.bottom),\n      closeOnOutsideClick: true,\n      animation: {\n        show: {\n          type: \"fade\",\n          from: 0,\n          to: 1\n        },\n        hide: {\n          type: \"fade\",\n          to: 0\n        }\n      },\n      showTitle: false,\n      width: \"auto\",\n      height: \"auto\",\n      dragEnabled: false,\n      resizeEnabled: false,\n      fullScreen: false,\n      hideOnParentScroll: true,\n      arrowPosition: \"\",\n      arrowOffset: 0,\n      _fixWrapperPosition: true\n    });\n  },\n  _defaultOptionsRules: function () {\n    return [{\n      device: {\n        platform: \"ios\"\n      },\n      options: {\n        arrowPosition: {\n          boundaryOffset: {\n            h: 20,\n            v: -10\n          },\n          collision: \"fit\"\n        }\n      }\n    }, {\n      device: function () {\n        return !hasWindow();\n      },\n      options: {\n        animation: null\n      }\n    }];\n  },\n  _init: function () {\n    this.callBase();\n\n    this._renderArrow();\n\n    this._timeouts = {};\n    this.$element().addClass(POPOVER_CLASS);\n    this.$wrapper().addClass(POPOVER_WRAPPER_CLASS);\n  },\n  _render: function () {\n    this.callBase.apply(this, arguments);\n\n    this._detachEvents(this.option(\"target\"));\n\n    this._attachEvents();\n  },\n  _detachEvents: function (target) {\n    detachEvent(this, target, \"show\");\n    detachEvent(this, target, \"hide\");\n  },\n  _attachEvents: function () {\n    attachEvent(this, \"show\");\n    attachEvent(this, \"hide\");\n  },\n  _renderArrow: function () {\n    this._$arrow = $(\"<div>\").addClass(POPOVER_ARROW_CLASS).prependTo(this.$overlayContent());\n  },\n  _documentDownHandler: function (e) {\n    if (this._isOutsideClick(e)) {\n      return this.callBase(e);\n    }\n\n    return true;\n  },\n  _isOutsideClick: function (e) {\n    return !$(e.target).closest(this.option(\"target\")).length;\n  },\n  _animate: function (animation) {\n    if (animation && animation.to && \"object\" === typeof animation.to) {\n      extend(animation.to, {\n        position: this._getContainerPosition()\n      });\n    }\n\n    this.callBase.apply(this, arguments);\n  },\n  _stopAnimation: function () {\n    this.callBase.apply(this, arguments);\n  },\n  _renderTitle: function () {\n    this.$wrapper().toggleClass(POPOVER_WITHOUT_TITLE_CLASS, !this.option(\"showTitle\"));\n    this.callBase();\n  },\n  _renderPosition: function () {\n    this.callBase();\n\n    this._renderOverlayPosition();\n\n    this._actions.onPositioned();\n  },\n  _renderOverlayPosition: function () {\n    this._resetOverlayPosition();\n\n    this._updateContentSize();\n\n    var contentPosition = this._getContainerPosition();\n\n    var resultLocation = positionUtils.setup(this.$overlayContent(), contentPosition);\n\n    var positionSide = this._getSideByLocation(resultLocation);\n\n    this._togglePositionClass(\"dx-position-\" + positionSide);\n\n    this._toggleFlippedClass(resultLocation.h.flip, resultLocation.v.flip);\n\n    var isArrowVisible = this._isHorizontalSide() || this._isVerticalSide();\n\n    if (isArrowVisible) {\n      this._renderArrowPosition(positionSide);\n    }\n  },\n  _resetOverlayPosition: function () {\n    this._setContentHeight(true);\n\n    this._togglePositionClass(\"dx-position-\" + this._positionController._positionSide);\n\n    move(this.$overlayContent(), {\n      left: 0,\n      top: 0\n    });\n\n    this._$arrow.css({\n      top: \"auto\",\n      right: \"auto\",\n      bottom: \"auto\",\n      left: \"auto\"\n    });\n  },\n  _updateContentSize: function () {\n    if (!this.$content()) {\n      return;\n    }\n\n    var containerLocation = positionUtils.calculate(this.$overlayContent(), this._getContainerPosition());\n\n    if (containerLocation.h.oversize > 0 && this._isHorizontalSide() && !containerLocation.h.fit) {\n      var newContainerWidth = getWidth(this.$overlayContent()) - containerLocation.h.oversize;\n      setWidth(this.$overlayContent(), newContainerWidth);\n    }\n\n    if (containerLocation.v.oversize > 0 && this._isVerticalSide() && !containerLocation.v.fit) {\n      var newOverlayContentHeight = getHeight(this.$overlayContent()) - containerLocation.v.oversize;\n      var newPopupContentHeight = getHeight(this.$content()) - containerLocation.v.oversize;\n      setHeight(this.$overlayContent(), newOverlayContentHeight);\n      setHeight(this.$content(), newPopupContentHeight);\n    }\n  },\n  _getContainerPosition: function () {\n    return this._positionController._getContainerPosition();\n  },\n  _getSideByLocation: function (location) {\n    var isFlippedByVertical = location.v.flip;\n    var isFlippedByHorizontal = location.h.flip;\n    return this._isVerticalSide() && isFlippedByVertical || this._isHorizontalSide() && isFlippedByHorizontal || this._isPopoverInside() ? POSITION_FLIP_MAP[this._positionController._positionSide] : this._positionController._positionSide;\n  },\n  _togglePositionClass: function (positionClass) {\n    this.$wrapper().removeClass(\"dx-position-left dx-position-right dx-position-top dx-position-bottom\").addClass(positionClass);\n  },\n  _toggleFlippedClass: function (isFlippedHorizontal, isFlippedVertical) {\n    this.$wrapper().toggleClass(\"dx-popover-flipped-horizontal\", isFlippedHorizontal).toggleClass(\"dx-popover-flipped-vertical\", isFlippedVertical);\n  },\n  _renderArrowPosition: function (side) {\n    var arrowRect = getBoundingRect(this._$arrow.get(0));\n    var arrowFlip = -(this._isVerticalSide(side) ? arrowRect.height : arrowRect.width);\n\n    this._$arrow.css(POSITION_FLIP_MAP[side], arrowFlip);\n\n    var axis = this._isVerticalSide(side) ? \"left\" : \"top\";\n    var sizeProperty = this._isVerticalSide(side) ? \"width\" : \"height\";\n    var $target = $(this._positionController._position.of);\n    var targetOffset = positionUtils.offset($target) || {\n      top: 0,\n      left: 0\n    };\n    var contentOffset = positionUtils.offset(this.$overlayContent());\n    var arrowSize = arrowRect[sizeProperty];\n    var contentLocation = contentOffset[axis];\n    var contentSize = getBoundingRect(this.$overlayContent().get(0))[sizeProperty];\n    var targetLocation = targetOffset[axis];\n    var targetElement = $target.get(0);\n    var targetSize = targetElement && !targetElement.preventDefault ? getBoundingRect(targetElement)[sizeProperty] : 0;\n    var min = Math.max(contentLocation, targetLocation);\n    var max = Math.min(contentLocation + contentSize, targetLocation + targetSize);\n    var arrowLocation;\n\n    if (\"start\" === this.option(\"arrowPosition\")) {\n      arrowLocation = min - contentLocation;\n    } else if (\"end\" === this.option(\"arrowPosition\")) {\n      arrowLocation = max - contentLocation - arrowSize;\n    } else {\n      arrowLocation = (min + max) / 2 - contentLocation - arrowSize / 2;\n    }\n\n    var borderWidth = this._positionController._getContentBorderWidth(side);\n\n    var finalArrowLocation = fitIntoRange(arrowLocation - borderWidth + this.option(\"arrowOffset\"), borderWidth, contentSize - arrowSize - 2 * borderWidth);\n\n    this._$arrow.css(axis, finalArrowLocation);\n  },\n  _isPopoverInside: function () {\n    return this._positionController._isPopoverInside();\n  },\n  _setContentHeight: function (fullUpdate) {\n    if (fullUpdate) {\n      this.callBase();\n    }\n  },\n\n  _getPositionControllerConfig() {\n    var {\n      shading: shading\n    } = this.option();\n    return extend({}, this.callBase(), {\n      shading: shading,\n      $arrow: this._$arrow\n    });\n  },\n\n  _initPositionController() {\n    this._positionController = new PopoverPositionController(this._getPositionControllerConfig());\n  },\n\n  _renderWrapperDimensions: function () {\n    if (this.option(\"shading\")) {\n      this.$wrapper().css({\n        width: \"100%\",\n        height: \"100%\"\n      });\n    }\n  },\n  _isVerticalSide: function (side) {\n    return this._positionController._isVerticalSide(side);\n  },\n  _isHorizontalSide: function (side) {\n    return this._positionController._isHorizontalSide(side);\n  },\n  _clearEventTimeout: function (name) {\n    clearTimeout(this._timeouts[name]);\n  },\n  _clearEventsTimeouts: function () {\n    this._clearEventTimeout(\"show\");\n\n    this._clearEventTimeout(\"hide\");\n  },\n  _clean: function () {\n    this._detachEvents(this.option(\"target\"));\n\n    this.callBase.apply(this, arguments);\n  },\n  _optionChanged: function (args) {\n    switch (args.name) {\n      case \"arrowPosition\":\n      case \"arrowOffset\":\n        this._renderGeometry();\n\n        break;\n\n      case \"fullScreen\":\n        if (args.value) {\n          this.option(\"fullScreen\", false);\n        }\n\n        break;\n\n      case \"target\":\n        args.previousValue && this._detachEvents(args.previousValue);\n        this.callBase(args);\n        break;\n\n      case \"showEvent\":\n      case \"hideEvent\":\n        var name = args.name.substring(0, 4);\n        var event = getEventNameByOption(args.previousValue);\n        this.hide();\n        detachEvent(this, this.option(\"target\"), name, event);\n        attachEvent(this, name);\n        break;\n\n      case \"visible\":\n        this._clearEventTimeout(args.value ? \"show\" : \"hide\");\n\n        this.callBase(args);\n        break;\n\n      default:\n        this.callBase(args);\n    }\n  },\n  show: function (target) {\n    if (target) {\n      this.option(\"target\", target);\n    }\n\n    return this.callBase();\n  }\n});\nregisterComponent(\"dxPopover\", Popover);\nexport default Popover;","map":{"version":3,"sources":["/home/narminali/Desktop/vabiss/narmin-oms-front/node_modules/devextreme/esm/ui/popover/ui.popover.js"],"names":["getWidth","setWidth","getHeight","setHeight","$","hasWindow","getPublicElement","domAdapter","eventsEngine","registerComponent","extend","move","positionUtils","isObject","isString","fitIntoRange","addNamespace","errors","Popup","getBoundingRect","PopoverPositionController","POPOVER_POSITION_ALIASES","POPOVER_CLASS","POPOVER_WRAPPER_CLASS","POPOVER_ARROW_CLASS","POPOVER_WITHOUT_TITLE_CLASS","POSITION_FLIP_MAP","left","top","right","bottom","center","getEventNameByOption","optionValue","name","getEventName","that","optionName","option","getEventDelay","delay","attachEvent","target","shading","disabled","hideEvent","isSelector","shouldIgnoreHideEvent","event","concat","log","eventName","NAME","action","_createAction","_clearEventsTimeouts","_timeouts","setTimeout","bind","validatingTargetName","handler","e","currentTarget","EVENT_HANDLER_NAME","on","getDocument","targetElement","detachEvent","off","Popover","inherit","_getDefaultOptions","callBase","position","closeOnOutsideClick","animation","show","type","from","to","hide","showTitle","width","height","dragEnabled","resizeEnabled","fullScreen","hideOnParentScroll","arrowPosition","arrowOffset","_fixWrapperPosition","_defaultOptionsRules","device","platform","options","boundaryOffset","h","v","collision","_init","_renderArrow","$element","addClass","$wrapper","_render","apply","arguments","_detachEvents","_attachEvents","_$arrow","prependTo","$overlayContent","_documentDownHandler","_isOutsideClick","closest","length","_animate","_getContainerPosition","_stopAnimation","_renderTitle","toggleClass","_renderPosition","_renderOverlayPosition","_actions","onPositioned","_resetOverlayPosition","_updateContentSize","contentPosition","resultLocation","setup","positionSide","_getSideByLocation","_togglePositionClass","_toggleFlippedClass","flip","isArrowVisible","_isHorizontalSide","_isVerticalSide","_renderArrowPosition","_setContentHeight","_positionController","_positionSide","css","$content","containerLocation","calculate","oversize","fit","newContainerWidth","newOverlayContentHeight","newPopupContentHeight","location","isFlippedByVertical","isFlippedByHorizontal","_isPopoverInside","positionClass","removeClass","isFlippedHorizontal","isFlippedVertical","side","arrowRect","get","arrowFlip","axis","sizeProperty","$target","_position","of","targetOffset","offset","contentOffset","arrowSize","contentLocation","contentSize","targetLocation","targetSize","preventDefault","min","Math","max","arrowLocation","borderWidth","_getContentBorderWidth","finalArrowLocation","fullUpdate","_getPositionControllerConfig","$arrow","_initPositionController","_renderWrapperDimensions","_clearEventTimeout","clearTimeout","_clean","_optionChanged","args","_renderGeometry","value","previousValue","substring"],"mappings":"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","sourcesContent":["/**\r\n * DevExtreme (esm/ui/popover/ui.popover.js)\r\n * Version: 21.2.3\r\n * Build date: Thu Oct 28 2021\r\n *\r\n * Copyright (c) 2012 - 2021 Developer Express Inc. ALL RIGHTS RESERVED\r\n * Read about DevExtreme licensing here: https://js.devexpress.com/Licensing/\r\n */\r\nimport {\r\n    getWidth,\r\n    setWidth,\r\n    getHeight,\r\n    setHeight\r\n} from \"../../core/utils/size\";\r\nimport $ from \"../../core/renderer\";\r\nimport {\r\n    hasWindow\r\n} from \"../../core/utils/window\";\r\nimport {\r\n    getPublicElement\r\n} from \"../../core/element\";\r\nimport domAdapter from \"../../core/dom_adapter\";\r\nimport eventsEngine from \"../../events/core/events_engine\";\r\nimport registerComponent from \"../../core/component_registrator\";\r\nimport {\r\n    extend\r\n} from \"../../core/utils/extend\";\r\nimport {\r\n    move\r\n} from \"../../animation/translator\";\r\nimport positionUtils from \"../../animation/position\";\r\nimport {\r\n    isObject,\r\n    isString\r\n} from \"../../core/utils/type\";\r\nimport {\r\n    fitIntoRange\r\n} from \"../../core/utils/math\";\r\nimport {\r\n    addNamespace\r\n} from \"../../events/utils/index\";\r\nimport errors from \"../widget/ui.errors\";\r\nimport Popup from \"../popup\";\r\nimport {\r\n    getBoundingRect\r\n} from \"../../core/utils/position\";\r\nimport {\r\n    PopoverPositionController,\r\n    POPOVER_POSITION_ALIASES\r\n} from \"./popover_position_controller\";\r\nvar POPOVER_CLASS = \"dx-popover\";\r\nvar POPOVER_WRAPPER_CLASS = \"dx-popover-wrapper\";\r\nvar POPOVER_ARROW_CLASS = \"dx-popover-arrow\";\r\nvar POPOVER_WITHOUT_TITLE_CLASS = \"dx-popover-without-title\";\r\nvar POSITION_FLIP_MAP = {\r\n    left: \"right\",\r\n    top: \"bottom\",\r\n    right: \"left\",\r\n    bottom: \"top\",\r\n    center: \"center\"\r\n};\r\nvar getEventNameByOption = function(optionValue) {\r\n    return isObject(optionValue) ? optionValue.name : optionValue\r\n};\r\nvar getEventName = function(that, optionName) {\r\n    var optionValue = that.option(optionName);\r\n    return getEventNameByOption(optionValue)\r\n};\r\nvar getEventDelay = function(that, optionName) {\r\n    var optionValue = that.option(optionName);\r\n    return isObject(optionValue) && optionValue.delay\r\n};\r\nvar attachEvent = function(that, name) {\r\n    var {\r\n        target: target,\r\n        shading: shading,\r\n        disabled: disabled,\r\n        hideEvent: hideEvent\r\n    } = that.option();\r\n    var isSelector = isString(target);\r\n    var shouldIgnoreHideEvent = shading && \"hide\" === name;\r\n    var event = shouldIgnoreHideEvent ? null : getEventName(that, \"\".concat(name, \"Event\"));\r\n    if (shouldIgnoreHideEvent && hideEvent) {\r\n        errors.log(\"W1020\")\r\n    }\r\n    if (!event || disabled) {\r\n        return\r\n    }\r\n    var eventName = addNamespace(event, that.NAME);\r\n    var action = that._createAction(function() {\r\n        var delay = getEventDelay(that, name + \"Event\");\r\n        this._clearEventsTimeouts();\r\n        if (delay) {\r\n            this._timeouts[name] = setTimeout((function() {\r\n                that[name]()\r\n            }), delay)\r\n        } else {\r\n            that[name]()\r\n        }\r\n    }.bind(that), {\r\n        validatingTargetName: \"target\"\r\n    });\r\n    var handler = function(e) {\r\n        action({\r\n            event: e,\r\n            target: $(e.currentTarget)\r\n        })\r\n    };\r\n    var EVENT_HANDLER_NAME = \"_\" + name + \"EventHandler\";\r\n    if (isSelector) {\r\n        that[EVENT_HANDLER_NAME] = handler;\r\n        eventsEngine.on(domAdapter.getDocument(), eventName, target, handler)\r\n    } else {\r\n        var targetElement = getPublicElement($(target));\r\n        that[EVENT_HANDLER_NAME] = void 0;\r\n        eventsEngine.on(targetElement, eventName, handler)\r\n    }\r\n};\r\nvar detachEvent = function(that, target, name, event) {\r\n    var eventName = event || getEventName(that, name + \"Event\");\r\n    if (!eventName) {\r\n        return\r\n    }\r\n    eventName = addNamespace(eventName, that.NAME);\r\n    var EVENT_HANDLER_NAME = \"_\" + name + \"EventHandler\";\r\n    if (that[EVENT_HANDLER_NAME]) {\r\n        eventsEngine.off(domAdapter.getDocument(), eventName, target, that[EVENT_HANDLER_NAME])\r\n    } else {\r\n        eventsEngine.off(getPublicElement($(target)), eventName)\r\n    }\r\n};\r\nvar Popover = Popup.inherit({\r\n    _getDefaultOptions: function() {\r\n        return extend(this.callBase(), {\r\n            target: void 0,\r\n            shading: false,\r\n            position: extend({}, POPOVER_POSITION_ALIASES.bottom),\r\n            closeOnOutsideClick: true,\r\n            animation: {\r\n                show: {\r\n                    type: \"fade\",\r\n                    from: 0,\r\n                    to: 1\r\n                },\r\n                hide: {\r\n                    type: \"fade\",\r\n                    to: 0\r\n                }\r\n            },\r\n            showTitle: false,\r\n            width: \"auto\",\r\n            height: \"auto\",\r\n            dragEnabled: false,\r\n            resizeEnabled: false,\r\n            fullScreen: false,\r\n            hideOnParentScroll: true,\r\n            arrowPosition: \"\",\r\n            arrowOffset: 0,\r\n            _fixWrapperPosition: true\r\n        })\r\n    },\r\n    _defaultOptionsRules: function() {\r\n        return [{\r\n            device: {\r\n                platform: \"ios\"\r\n            },\r\n            options: {\r\n                arrowPosition: {\r\n                    boundaryOffset: {\r\n                        h: 20,\r\n                        v: -10\r\n                    },\r\n                    collision: \"fit\"\r\n                }\r\n            }\r\n        }, {\r\n            device: function() {\r\n                return !hasWindow()\r\n            },\r\n            options: {\r\n                animation: null\r\n            }\r\n        }]\r\n    },\r\n    _init: function() {\r\n        this.callBase();\r\n        this._renderArrow();\r\n        this._timeouts = {};\r\n        this.$element().addClass(POPOVER_CLASS);\r\n        this.$wrapper().addClass(POPOVER_WRAPPER_CLASS)\r\n    },\r\n    _render: function() {\r\n        this.callBase.apply(this, arguments);\r\n        this._detachEvents(this.option(\"target\"));\r\n        this._attachEvents()\r\n    },\r\n    _detachEvents: function(target) {\r\n        detachEvent(this, target, \"show\");\r\n        detachEvent(this, target, \"hide\")\r\n    },\r\n    _attachEvents: function() {\r\n        attachEvent(this, \"show\");\r\n        attachEvent(this, \"hide\")\r\n    },\r\n    _renderArrow: function() {\r\n        this._$arrow = $(\"<div>\").addClass(POPOVER_ARROW_CLASS).prependTo(this.$overlayContent())\r\n    },\r\n    _documentDownHandler: function(e) {\r\n        if (this._isOutsideClick(e)) {\r\n            return this.callBase(e)\r\n        }\r\n        return true\r\n    },\r\n    _isOutsideClick: function(e) {\r\n        return !$(e.target).closest(this.option(\"target\")).length\r\n    },\r\n    _animate: function(animation) {\r\n        if (animation && animation.to && \"object\" === typeof animation.to) {\r\n            extend(animation.to, {\r\n                position: this._getContainerPosition()\r\n            })\r\n        }\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _stopAnimation: function() {\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _renderTitle: function() {\r\n        this.$wrapper().toggleClass(POPOVER_WITHOUT_TITLE_CLASS, !this.option(\"showTitle\"));\r\n        this.callBase()\r\n    },\r\n    _renderPosition: function() {\r\n        this.callBase();\r\n        this._renderOverlayPosition();\r\n        this._actions.onPositioned()\r\n    },\r\n    _renderOverlayPosition: function() {\r\n        this._resetOverlayPosition();\r\n        this._updateContentSize();\r\n        var contentPosition = this._getContainerPosition();\r\n        var resultLocation = positionUtils.setup(this.$overlayContent(), contentPosition);\r\n        var positionSide = this._getSideByLocation(resultLocation);\r\n        this._togglePositionClass(\"dx-position-\" + positionSide);\r\n        this._toggleFlippedClass(resultLocation.h.flip, resultLocation.v.flip);\r\n        var isArrowVisible = this._isHorizontalSide() || this._isVerticalSide();\r\n        if (isArrowVisible) {\r\n            this._renderArrowPosition(positionSide)\r\n        }\r\n    },\r\n    _resetOverlayPosition: function() {\r\n        this._setContentHeight(true);\r\n        this._togglePositionClass(\"dx-position-\" + this._positionController._positionSide);\r\n        move(this.$overlayContent(), {\r\n            left: 0,\r\n            top: 0\r\n        });\r\n        this._$arrow.css({\r\n            top: \"auto\",\r\n            right: \"auto\",\r\n            bottom: \"auto\",\r\n            left: \"auto\"\r\n        })\r\n    },\r\n    _updateContentSize: function() {\r\n        if (!this.$content()) {\r\n            return\r\n        }\r\n        var containerLocation = positionUtils.calculate(this.$overlayContent(), this._getContainerPosition());\r\n        if (containerLocation.h.oversize > 0 && this._isHorizontalSide() && !containerLocation.h.fit) {\r\n            var newContainerWidth = getWidth(this.$overlayContent()) - containerLocation.h.oversize;\r\n            setWidth(this.$overlayContent(), newContainerWidth)\r\n        }\r\n        if (containerLocation.v.oversize > 0 && this._isVerticalSide() && !containerLocation.v.fit) {\r\n            var newOverlayContentHeight = getHeight(this.$overlayContent()) - containerLocation.v.oversize;\r\n            var newPopupContentHeight = getHeight(this.$content()) - containerLocation.v.oversize;\r\n            setHeight(this.$overlayContent(), newOverlayContentHeight);\r\n            setHeight(this.$content(), newPopupContentHeight)\r\n        }\r\n    },\r\n    _getContainerPosition: function() {\r\n        return this._positionController._getContainerPosition()\r\n    },\r\n    _getSideByLocation: function(location) {\r\n        var isFlippedByVertical = location.v.flip;\r\n        var isFlippedByHorizontal = location.h.flip;\r\n        return this._isVerticalSide() && isFlippedByVertical || this._isHorizontalSide() && isFlippedByHorizontal || this._isPopoverInside() ? POSITION_FLIP_MAP[this._positionController._positionSide] : this._positionController._positionSide\r\n    },\r\n    _togglePositionClass: function(positionClass) {\r\n        this.$wrapper().removeClass(\"dx-position-left dx-position-right dx-position-top dx-position-bottom\").addClass(positionClass)\r\n    },\r\n    _toggleFlippedClass: function(isFlippedHorizontal, isFlippedVertical) {\r\n        this.$wrapper().toggleClass(\"dx-popover-flipped-horizontal\", isFlippedHorizontal).toggleClass(\"dx-popover-flipped-vertical\", isFlippedVertical)\r\n    },\r\n    _renderArrowPosition: function(side) {\r\n        var arrowRect = getBoundingRect(this._$arrow.get(0));\r\n        var arrowFlip = -(this._isVerticalSide(side) ? arrowRect.height : arrowRect.width);\r\n        this._$arrow.css(POSITION_FLIP_MAP[side], arrowFlip);\r\n        var axis = this._isVerticalSide(side) ? \"left\" : \"top\";\r\n        var sizeProperty = this._isVerticalSide(side) ? \"width\" : \"height\";\r\n        var $target = $(this._positionController._position.of);\r\n        var targetOffset = positionUtils.offset($target) || {\r\n            top: 0,\r\n            left: 0\r\n        };\r\n        var contentOffset = positionUtils.offset(this.$overlayContent());\r\n        var arrowSize = arrowRect[sizeProperty];\r\n        var contentLocation = contentOffset[axis];\r\n        var contentSize = getBoundingRect(this.$overlayContent().get(0))[sizeProperty];\r\n        var targetLocation = targetOffset[axis];\r\n        var targetElement = $target.get(0);\r\n        var targetSize = targetElement && !targetElement.preventDefault ? getBoundingRect(targetElement)[sizeProperty] : 0;\r\n        var min = Math.max(contentLocation, targetLocation);\r\n        var max = Math.min(contentLocation + contentSize, targetLocation + targetSize);\r\n        var arrowLocation;\r\n        if (\"start\" === this.option(\"arrowPosition\")) {\r\n            arrowLocation = min - contentLocation\r\n        } else if (\"end\" === this.option(\"arrowPosition\")) {\r\n            arrowLocation = max - contentLocation - arrowSize\r\n        } else {\r\n            arrowLocation = (min + max) / 2 - contentLocation - arrowSize / 2\r\n        }\r\n        var borderWidth = this._positionController._getContentBorderWidth(side);\r\n        var finalArrowLocation = fitIntoRange(arrowLocation - borderWidth + this.option(\"arrowOffset\"), borderWidth, contentSize - arrowSize - 2 * borderWidth);\r\n        this._$arrow.css(axis, finalArrowLocation)\r\n    },\r\n    _isPopoverInside: function() {\r\n        return this._positionController._isPopoverInside()\r\n    },\r\n    _setContentHeight: function(fullUpdate) {\r\n        if (fullUpdate) {\r\n            this.callBase()\r\n        }\r\n    },\r\n    _getPositionControllerConfig() {\r\n        var {\r\n            shading: shading\r\n        } = this.option();\r\n        return extend({}, this.callBase(), {\r\n            shading: shading,\r\n            $arrow: this._$arrow\r\n        })\r\n    },\r\n    _initPositionController() {\r\n        this._positionController = new PopoverPositionController(this._getPositionControllerConfig())\r\n    },\r\n    _renderWrapperDimensions: function() {\r\n        if (this.option(\"shading\")) {\r\n            this.$wrapper().css({\r\n                width: \"100%\",\r\n                height: \"100%\"\r\n            })\r\n        }\r\n    },\r\n    _isVerticalSide: function(side) {\r\n        return this._positionController._isVerticalSide(side)\r\n    },\r\n    _isHorizontalSide: function(side) {\r\n        return this._positionController._isHorizontalSide(side)\r\n    },\r\n    _clearEventTimeout: function(name) {\r\n        clearTimeout(this._timeouts[name])\r\n    },\r\n    _clearEventsTimeouts: function() {\r\n        this._clearEventTimeout(\"show\");\r\n        this._clearEventTimeout(\"hide\")\r\n    },\r\n    _clean: function() {\r\n        this._detachEvents(this.option(\"target\"));\r\n        this.callBase.apply(this, arguments)\r\n    },\r\n    _optionChanged: function(args) {\r\n        switch (args.name) {\r\n            case \"arrowPosition\":\r\n            case \"arrowOffset\":\r\n                this._renderGeometry();\r\n                break;\r\n            case \"fullScreen\":\r\n                if (args.value) {\r\n                    this.option(\"fullScreen\", false)\r\n                }\r\n                break;\r\n            case \"target\":\r\n                args.previousValue && this._detachEvents(args.previousValue);\r\n                this.callBase(args);\r\n                break;\r\n            case \"showEvent\":\r\n            case \"hideEvent\":\r\n                var name = args.name.substring(0, 4);\r\n                var event = getEventNameByOption(args.previousValue);\r\n                this.hide();\r\n                detachEvent(this, this.option(\"target\"), name, event);\r\n                attachEvent(this, name);\r\n                break;\r\n            case \"visible\":\r\n                this._clearEventTimeout(args.value ? \"show\" : \"hide\");\r\n                this.callBase(args);\r\n                break;\r\n            default:\r\n                this.callBase(args)\r\n        }\r\n    },\r\n    show: function(target) {\r\n        if (target) {\r\n            this.option(\"target\", target)\r\n        }\r\n        return this.callBase()\r\n    }\r\n});\r\nregisterComponent(\"dxPopover\", Popover);\r\nexport default Popover;\r\n"]},"metadata":{},"sourceType":"module"}